:PROPERTIES:
:ID:       69d543a9-0941-4dba-8120-7af004a35957
:END:
#+title: Kubernetes Service

* References
- link: [[https://kubernetes.io/docs/concepts/services-networking/service/][Kubernetes Service]]

* Service resource
** Example
#+begin_src yaml
apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  selector:
    app: MyApp
  ports:
    - protocol: TCP
      port: 80
      targetPort: 9376
#+end_src

- This specification creates a new Service object named /my-service/, which targets TCP port 9376 on any Pod with the ~app=MyApp~ label
- The controller for the Service selector continuously scans for Pods that match its selector, and then POSTs any updates to an Endpoint object also named /my-service/

* Service without a selector
- you can reference external services using a service without a selector
- selector just creates a *Kubernetes Endpoint* object that points to another k8s resource

- when creating a service without a selector, k8s endpoint must be created explicitly
  - these two are linked using ~medatada.name~ field

** Example
#+begin_src yaml
apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  ports:
    - protocol: TCP
      port: 80
      targetPort: 9200
---
apiVersion: v1
kind: Endpoints
metadata:
  name: my-service
subsets:
  - addresses:
      - ip: 192.0.2.42
    ports:
      - port: 9200
#+end_src

* Service Types
- ~Cluster IP~ < ~NodePort~ < ~LoadBalancer~

** Cluster IP
